## <font style="color:rgb(0, 0, 0);">1. 系统架构设计</font>
### <font style="color:rgb(0, 0, 0);">1.1 总体架构</font>
<font style="color:rgb(0, 0, 0);">采用前后端分离架构：</font>

```plain
客户端（浏览器） → 前端应用（Vue3） → 后端API（SpringBoot3） → 数据库/文件存储
```

### <font style="color:rgb(0, 0, 0);">1.2 技术栈详情</font>
| **<font style="color:rgb(0, 0, 0) !important;">模块</font>** | **<font style="color:rgb(0, 0, 0) !important;">技术选型</font>** | **<font style="color:rgb(0, 0, 0) !important;">作用说明</font>** |
| :--- | :--- | :--- |
| <font style="color:rgba(0, 0, 0, 0.85) !important;">前端</font> | <font style="color:rgba(0, 0, 0, 0.85) !important;">Vue3 + TypeScript</font> | <font style="color:rgba(0, 0, 0, 0.85) !important;">组件化开发，类型约束保证代码健壮性</font> |
| <font style="color:rgba(0, 0, 0, 0.85) !important;">前端</font> | <font style="color:rgba(0, 0, 0, 0.85) !important;">Vite3</font> | <font style="color:rgba(0, 0, 0, 0.85) !important;">快速构建工具，提升开发效率</font> |
| <font style="color:rgba(0, 0, 0, 0.85) !important;">前端</font> | <font style="color:rgba(0, 0, 0, 0.85) !important;">Element Plus</font> | <font style="color:rgba(0, 0, 0, 0.85) !important;">提供 UI 组件（上传、表格、表单等）</font> |
| <font style="color:rgba(0, 0, 0, 0.85) !important;">前端</font> | <font style="color:rgba(0, 0, 0, 0.85) !important;">Pinia</font> | <font style="color:rgba(0, 0, 0, 0.85) !important;">状态管理（存储登录用户、全局配置等）</font> |
| <font style="color:rgba(0, 0, 0, 0.85) !important;">后端</font> | <font style="color:rgba(0, 0, 0, 0.85) !important;">Java17 + SpringBoot3</font> | <font style="color:rgba(0, 0, 0, 0.85) !important;">后端开发框架，支持模块化和依赖注入</font> |
| <font style="color:rgba(0, 0, 0, 0.85) !important;">后端</font> | <font style="color:rgba(0, 0, 0, 0.85) !important;">Sa-Token</font> | <font style="color:rgba(0, 0, 0, 0.85) !important;">处理登录认证、Token 管理</font> |
| <font style="color:rgba(0, 0, 0, 0.85) !important;">后端</font> | <font style="color:rgba(0, 0, 0, 0.85) !important;">MyBatis-Plus</font> | <font style="color:rgba(0, 0, 0, 0.85) !important;">简化数据库 CRUD 操作，支持分页、条件查询</font> |
| <font style="color:rgba(0, 0, 0, 0.85) !important;">后端</font> | <font style="color:rgba(0, 0, 0, 0.85) !important;">Redis</font> | <font style="color:rgba(0, 0, 0, 0.85) !important;">缓存用户会话、分享链接有效期</font> |
| <font style="color:rgba(0, 0, 0, 0.85) !important;">后端</font> | <font style="color:rgba(0, 0, 0, 0.85) !important;">MySQL</font> | <font style="color:rgba(0, 0, 0, 0.85) !important;">存储用户、论文、文件夹等结构化数据</font> |
| <font style="color:rgba(0, 0, 0, 0.85) !important;">后端</font> | <font style="color:rgba(0, 0, 0, 0.85) !important;">Druid</font> | <font style="color:rgba(0, 0, 0, 0.85) !important;">数据库连接池，监控 SQL 执行</font> |
| <font style="color:rgba(0, 0, 0, 0.85) !important;">文件存储</font> | <font style="color:rgba(0, 0, 0, 0.85) !important;">服务器本地磁盘</font> | <font style="color:rgba(0, 0, 0, 0.85) !important;">存储上传的论文文件（路径记录在数据库）</font> |


## <font style="color:rgb(0, 0, 0);">2. 数据库设计</font>
### <font style="color:rgb(0, 0, 0);">2.1 核心表结构</font>
#### <font style="color:rgb(0, 0, 0);">用户表（user）</font>
| **<font style="color:rgb(0, 0, 0) !important;">字段名</font>** | **<font style="color:rgb(0, 0, 0) !important;">类型</font>** | **<font style="color:rgb(0, 0, 0) !important;">说明</font>** |
| :--- | :--- | :--- |
| <font style="color:rgba(0, 0, 0, 0.85) !important;">id</font> | <font style="color:rgba(0, 0, 0, 0.85) !important;">bigint</font> | <font style="color:rgba(0, 0, 0, 0.85) !important;">主键（自增）</font> |
| <font style="color:rgba(0, 0, 0, 0.85) !important;">username</font> | <font style="color:rgba(0, 0, 0, 0.85) !important;">varchar(50)</font> | <font style="color:rgba(0, 0, 0, 0.85) !important;">用户名（唯一）</font> |
| <font style="color:rgba(0, 0, 0, 0.85) !important;">password</font> | <font style="color:rgba(0, 0, 0, 0.85) !important;">varchar(100)</font> | <font style="color:rgba(0, 0, 0, 0.85) !important;">加密密码（BCrypt）</font> |
| <font style="color:rgba(0, 0, 0, 0.85) !important;">create_time</font> | <font style="color:rgba(0, 0, 0, 0.85) !important;">datetime</font> | <font style="color:rgba(0, 0, 0, 0.85) !important;">创建时间</font> |
| <font style="color:rgba(0, 0, 0, 0.85) !important;">update_time</font> | <font style="color:rgba(0, 0, 0, 0.85) !important;">datetime</font> | <font style="color:rgba(0, 0, 0, 0.85) !important;">更新时间</font> |


#### <font style="color:rgb(0, 0, 0);">论文表（paper）</font>
| **<font style="color:rgb(0, 0, 0) !important;">字段名</font>** | **<font style="color:rgb(0, 0, 0) !important;">类型</font>** | **<font style="color:rgb(0, 0, 0) !important;">说明</font>** |
| :--- | :--- | :--- |
| <font style="color:rgba(0, 0, 0, 0.85) !important;">id</font> | <font style="color:rgba(0, 0, 0, 0.85) !important;">bigint</font> | <font style="color:rgba(0, 0, 0, 0.85) !important;">主键</font> |
| <font style="color:rgba(0, 0, 0, 0.85) !important;">title</font> | <font style="color:rgba(0, 0, 0, 0.85) !important;">varchar(255)</font> | <font style="color:rgba(0, 0, 0, 0.85) !important;">论文标题</font> |
| <font style="color:rgba(0, 0, 0, 0.85) !important;">author</font> | <font style="color:rgba(0, 0, 0, 0.85) !important;">varchar(255)</font> | <font style="color:rgba(0, 0, 0, 0.85) !important;">作者</font> |
| <font style="color:rgba(0, 0, 0, 0.85) !important;">publish_time</font> | <font style="color:rgba(0, 0, 0, 0.85) !important;">date</font> | <font style="color:rgba(0, 0, 0, 0.85) !important;">发表时间</font> |
| <font style="color:rgba(0, 0, 0, 0.85) !important;">journal</font> | <font style="color:rgba(0, 0, 0, 0.85) !important;">varchar(100)</font> | <font style="color:rgba(0, 0, 0, 0.85) !important;">发表期刊</font> |
| <font style="color:rgba(0, 0, 0, 0.85) !important;">journal_type</font> | <font style="color:rgba(0, 0, 0, 0.85) !important;">varchar(50)</font> | <font style="color:rgba(0, 0, 0, 0.85) !important;">期刊类型（如 SCI / 核心）</font> |
| <font style="color:rgba(0, 0, 0, 0.85) !important;">research_direction</font> | <font style="color:rgba(0, 0, 0, 0.85) !important;">text</font> | <font style="color:rgba(0, 0, 0, 0.85) !important;">研究方向</font> |
| <font style="color:rgba(0, 0, 0, 0.85) !important;">innovation</font> | <font style="color:rgba(0, 0, 0, 0.85) !important;">text</font> | <font style="color:rgba(0, 0, 0, 0.85) !important;">创新点</font> |
| <font style="color:rgba(0, 0, 0, 0.85) !important;">deficiency</font> | <font style="color:rgba(0, 0, 0, 0.85) !important;">text</font> | <font style="color:rgba(0, 0, 0, 0.85) !important;">不足</font> |
| <font style="color:rgba(0, 0, 0, 0.85) !important;">file_path</font> | <font style="color:rgba(0, 0, 0, 0.85) !important;">varchar(255)</font> | <font style="color:rgba(0, 0, 0, 0.85) !important;">文件存储路径</font> |
| <font style="color:rgba(0, 0, 0, 0.85) !important;">file_size</font> | <font style="color:rgba(0, 0, 0, 0.85) !important;">bigint</font> | <font style="color:rgba(0, 0, 0, 0.85) !important;">文件大小（字节）</font> |
| <font style="color:rgba(0, 0, 0, 0.85) !important;">file_hash</font> | <font style="color:rgba(0, 0, 0, 0.85) !important;">varchar(64)</font> | <font style="color:rgba(0, 0, 0, 0.85) !important;">文件 MD5 哈希（去重）</font> |
| <font style="color:rgba(0, 0, 0, 0.85) !important;">keywords</font> | <font style="color:rgba(0, 0, 0, 0.85) !important;">varchar(255)</font> | <font style="color:rgba(0, 0, 0, 0.85) !important;">关键词（逗号分隔）</font> |
| <font style="color:rgba(0, 0, 0, 0.85) !important;">create_user</font> | <font style="color:rgba(0, 0, 0, 0.85) !important;">bigint</font> | <font style="color:rgba(0, 0, 0, 0.85) !important;">上传人 ID（关联 user 表）</font> |
| <font style="color:rgba(0, 0, 0, 0.85) !important;">create_time</font> | <font style="color:rgba(0, 0, 0, 0.85) !important;">datetime</font> | <font style="color:rgba(0, 0, 0, 0.85) !important;">上传时间</font> |
| <font style="color:rgba(0, 0, 0, 0.85) !important;">update_time</font> | <font style="color:rgba(0, 0, 0, 0.85) !important;">datetime</font> | <font style="color:rgba(0, 0, 0, 0.85) !important;">最后编辑时间</font> |
| <font style="color:rgba(0, 0, 0, 0.85) !important;">is_deleted</font> | <font style="color:rgba(0, 0, 0, 0.85) !important;">tinyint</font> | <font style="color:rgba(0, 0, 0, 0.85) !important;">是否删除（0 - 正常，1 - 回收站）</font> |


#### <font style="color:rgb(0, 0, 0);">文件夹表（folder）</font>
| **<font style="color:rgb(0, 0, 0) !important;">字段名</font>** | **<font style="color:rgb(0, 0, 0) !important;">类型</font>** | **<font style="color:rgb(0, 0, 0) !important;">说明</font>** |
| :--- | :--- | :--- |
| <font style="color:rgba(0, 0, 0, 0.85) !important;">id</font> | <font style="color:rgba(0, 0, 0, 0.85) !important;">bigint</font> | <font style="color:rgba(0, 0, 0, 0.85) !important;">主键</font> |
| <font style="color:rgba(0, 0, 0, 0.85) !important;">name</font> | <font style="color:rgba(0, 0, 0, 0.85) !important;">varchar(100)</font> | <font style="color:rgba(0, 0, 0, 0.85) !important;">文件夹名称</font> |
| <font style="color:rgba(0, 0, 0, 0.85) !important;">parent_id</font> | <font style="color:rgba(0, 0, 0, 0.85) !important;">bigint</font> | <font style="color:rgba(0, 0, 0, 0.85) !important;">父文件夹 ID（0 为根目录）</font> |
| <font style="color:rgba(0, 0, 0, 0.85) !important;">create_user</font> | <font style="color:rgba(0, 0, 0, 0.85) !important;">bigint</font> | <font style="color:rgba(0, 0, 0, 0.85) !important;">创建人 ID</font> |
| <font style="color:rgba(0, 0, 0, 0.85) !important;">create_time</font> | <font style="color:rgba(0, 0, 0, 0.85) !important;">datetime</font> | <font style="color:rgba(0, 0, 0, 0.85) !important;">创建时间</font> |


#### <font style="color:rgb(0, 0, 0);">论文 - 文件夹关联表（paper_folder）</font>
| **<font style="color:rgb(0, 0, 0) !important;">字段名</font>** | **<font style="color:rgb(0, 0, 0) !important;">类型</font>** | **<font style="color:rgb(0, 0, 0) !important;">说明</font>** |
| :--- | :--- | :--- |
| <font style="color:rgba(0, 0, 0, 0.85) !important;">id</font> | <font style="color:rgba(0, 0, 0, 0.85) !important;">bigint</font> | <font style="color:rgba(0, 0, 0, 0.85) !important;">主键</font> |
| <font style="color:rgba(0, 0, 0, 0.85) !important;">paper_id</font> | <font style="color:rgba(0, 0, 0, 0.85) !important;">bigint</font> | <font style="color:rgba(0, 0, 0, 0.85) !important;">论文 ID</font> |
| <font style="color:rgba(0, 0, 0, 0.85) !important;">folder_id</font> | <font style="color:rgba(0, 0, 0, 0.85) !important;">bigint</font> | <font style="color:rgba(0, 0, 0, 0.85) !important;">文件夹 ID</font> |


#### <font style="color:rgb(0, 0, 0);">回收站表（recycle_bin）</font>
| **<font style="color:rgb(0, 0, 0) !important;">字段名</font>** | **<font style="color:rgb(0, 0, 0) !important;">类型</font>** | **<font style="color:rgb(0, 0, 0) !important;">说明</font>** |
| :--- | :--- | :--- |
| <font style="color:rgba(0, 0, 0, 0.85) !important;">id</font> | <font style="color:rgba(0, 0, 0, 0.85) !important;">bigint</font> | <font style="color:rgba(0, 0, 0, 0.85) !important;">主键</font> |
| <font style="color:rgba(0, 0, 0, 0.85) !important;">paper_id</font> | <font style="color:rgba(0, 0, 0, 0.85) !important;">bigint</font> | <font style="color:rgba(0, 0, 0, 0.85) !important;">论文 ID</font> |
| <font style="color:rgba(0, 0, 0, 0.85) !important;">delete_time</font> | <font style="color:rgba(0, 0, 0, 0.85) !important;">datetime</font> | <font style="color:rgba(0, 0, 0, 0.85) !important;">删除时间（用于定时清理）</font> |
| <font style="color:rgba(0, 0, 0, 0.85) !important;">delete_user</font> | <font style="color:rgba(0, 0, 0, 0.85) !important;">bigint</font> | <font style="color:rgba(0, 0, 0, 0.85) !important;">删除人 ID</font> |


#### <font style="color:rgb(0, 0, 0);">分享表（share）</font>
| **<font style="color:rgb(0, 0, 0) !important;">字段名</font>** | **<font style="color:rgb(0, 0, 0) !important;">类型</font>** | **<font style="color:rgb(0, 0, 0) !important;">说明</font>** |
| :--- | :--- | :--- |
| <font style="color:rgba(0, 0, 0, 0.85) !important;">id</font> | <font style="color:rgba(0, 0, 0, 0.85) !important;">bigint</font> | <font style="color:rgba(0, 0, 0, 0.85) !important;">主键</font> |
| <font style="color:rgba(0, 0, 0, 0.85) !important;">paper_id</font> | <font style="color:rgba(0, 0, 0, 0.85) !important;">bigint</font> | <font style="color:rgba(0, 0, 0, 0.85) !important;">论文 ID</font> |
| <font style="color:rgba(0, 0, 0, 0.85) !important;">share_token</font> | <font style="color:rgba(0, 0, 0, 0.85) !important;">varchar(64)</font> | <font style="color:rgba(0, 0, 0, 0.85) !important;">分享唯一标识（UUID）</font> |
| <font style="color:rgba(0, 0, 0, 0.85) !important;">expire_time</font> | <font style="color:rgba(0, 0, 0, 0.85) !important;">datetime</font> | <font style="color:rgba(0, 0, 0, 0.85) !important;">过期时间（null 为永久）</font> |
| <font style="color:rgba(0, 0, 0, 0.85) !important;">share_type</font> | <font style="color:rgba(0, 0, 0, 0.85) !important;">tinyint</font> | <font style="color:rgba(0, 0, 0, 0.85) !important;">类型（1 - 原文，2 - 归纳内容）</font> |
| <font style="color:rgba(0, 0, 0, 0.85) !important;">permission</font> | <font style="color:rgba(0, 0, 0, 0.85) !important;">tinyint</font> | <font style="color:rgba(0, 0, 0, 0.85) !important;">权限（1 - 仅查看，2 - 允许下载）</font> |
| <font style="color:rgba(0, 0, 0, 0.85) !important;">create_time</font> | <font style="color:rgba(0, 0, 0, 0.85) !important;">datetime</font> | <font style="color:rgba(0, 0, 0, 0.85) !important;">创建时间</font> |


#### <font style="color:rgb(0, 0, 0);">引用格式表（citation_format）</font>
| **<font style="color:rgb(0, 0, 0) !important;">字段名</font>** | **<font style="color:rgb(0, 0, 0) !important;">类型</font>** | **<font style="color:rgb(0, 0, 0) !important;">说明</font>** |
| :--- | :--- | :--- |
| <font style="color:rgba(0, 0, 0, 0.85) !important;">id</font> | <font style="color:rgba(0, 0, 0, 0.85) !important;">bigint</font> | <font style="color:rgba(0, 0, 0, 0.85) !important;">主键</font> |
| <font style="color:rgba(0, 0, 0, 0.85) !important;">name</font> | <font style="color:rgba(0, 0, 0, 0.85) !important;">varchar(50)</font> | <font style="color:rgba(0, 0, 0, 0.85) !important;">格式名称（如 APA）</font> |
| <font style="color:rgba(0, 0, 0, 0.85) !important;">template</font> | <font style="color:rgba(0, 0, 0, 0.85) !important;">text</font> | <font style="color:rgba(0, 0, 0, 0.85) !important;">模板（如</font>`<font style="color:rgb(0, 0, 0);">{author}.{title}[J]...</font>`<br/><font style="color:rgba(0, 0, 0, 0.85) !important;">）</font> |
| <font style="color:rgba(0, 0, 0, 0.85) !important;">is_default</font> | <font style="color:rgba(0, 0, 0, 0.85) !important;">tinyint</font> | <font style="color:rgba(0, 0, 0, 0.85) !important;">是否默认（1 - 是，0 - 否）</font> |


## <font style="color:rgb(0, 0, 0);">3. 前端设计</font>
### <font style="color:rgb(0, 0, 0);">3.1 页面结构</font>
+ <font style="color:rgb(0, 0, 0);">登录页（/login）</font>
+ <font style="color:rgb(0, 0, 0);">首页（/home）：左侧文件夹树 + 右侧论文列表</font>
+ <font style="color:rgb(0, 0, 0);">论文详情页（/paper/:id）：信息编辑、引用生成、分享</font>
+ <font style="color:rgb(0, 0, 0);">上传页（/upload）：单文件 / 批量上传组件</font>
+ <font style="color:rgb(0, 0, 0);">回收站（/recycle）：已删除论文列表</font>
+ <font style="color:rgb(0, 0, 0);">用户管理页（/user）：用户列表、新建用户</font>

### <font style="color:rgb(0, 0, 0);">3.2 核心组件</font>
+ `<font style="color:rgb(0, 0, 0);">FileUpload</font>`<font style="color:rgb(0, 0, 0);">：文件上传组件（支持拖拽、进度条）</font>
+ `<font style="color:rgb(0, 0, 0);">PaperList</font>`<font style="color:rgb(0, 0, 0);">：论文列表（支持筛选、排序、批量操作）</font>
+ `<font style="color:rgb(0, 0, 0);">FolderTree</font>`<font style="color:rgb(0, 0, 0);">：文件夹树形组件（支持多级目录、拖拽）</font>
+ `<font style="color:rgb(0, 0, 0);">CitationGenerator</font>`<font style="color:rgb(0, 0, 0);">：引用生成组件（格式选择、预览、复制）</font>

## <font style="color:rgb(0, 0, 0);">4. 后端设计</font>
### <font style="color:rgb(0, 0, 0);">4.1 分层架构</font>
```plain
Controller（接口层） → Service（业务逻辑层） → Mapper（数据访问层） → 数据库
```

### <font style="color:rgb(0, 0, 0);">4.2 核心模块流程</font>
#### <font style="color:rgb(0, 0, 0);">4.2.1 论文上传流程</font>
1. <font style="color:rgb(0, 0, 0);">前端上传文件 → 后端接收</font>`<font style="color:rgb(0, 0, 0);">MultipartFile</font>`
2. <font style="color:rgb(0, 0, 0);">计算文件 MD5 哈希，检查是否已存在（查</font>`<font style="color:rgb(0, 0, 0);">paper</font>`<font style="color:rgb(0, 0, 0);">表</font>`<font style="color:rgb(0, 0, 0);">file_hash</font>`<font style="color:rgb(0, 0, 0);">）</font>
3. <font style="color:rgb(0, 0, 0);">若不存在，保存文件到服务器目录（如</font>`<font style="color:rgb(0, 0, 0);">/data/papers/</font>`<font style="color:rgb(0, 0, 0);">）</font>
4. <font style="color:rgb(0, 0, 0);">调用 PDF 解析工具提取元数据（标题、作者等）</font>
5. <font style="color:rgb(0, 0, 0);">插入</font>`<font style="color:rgb(0, 0, 0);">paper</font>`<font style="color:rgb(0, 0, 0);">表记录，返回论文 ID</font>

#### <font style="color:rgb(0, 0, 0);">4.2.2 大模型归纳流程</font>
1. <font style="color:rgb(0, 0, 0);">用户触发归纳 → 后端读取论文文件文本</font>
2. <font style="color:rgb(0, 0, 0);">调用大模型 API，传入提示词：</font>

```plain
"请归纳以下论文的研究方向、创新点和不足：{论文文本}"
```

3. <font style="color:rgb(0, 0, 0);">解析 API 返回结果，更新</font>`<font style="color:rgb(0, 0, 0);">paper</font>`<font style="color:rgb(0, 0, 0);">表</font>`<font style="color:rgb(0, 0, 0);">research_direction</font>`<font style="color:rgb(0, 0, 0);">等字段</font>
4. <font style="color:rgb(0, 0, 0);">保存历史版本（可选，新增</font>`<font style="color:rgb(0, 0, 0);">paper_induction_history</font>`<font style="color:rgb(0, 0, 0);">表）</font>

#### <font style="color:rgb(0, 0, 0);">4.2.3 分享链接生成流程</font>
1. <font style="color:rgb(0, 0, 0);">用户选择分享类型和权限 → 后端生成 32 位 UUID 作为</font>`<font style="color:rgb(0, 0, 0);">share_token</font>`
2. <font style="color:rgb(0, 0, 0);">根据用户选择设置</font>`<font style="color:rgb(0, 0, 0);">expire_time</font>`<font style="color:rgb(0, 0, 0);">（如 7 天后）</font>
3. <font style="color:rgb(0, 0, 0);">插入</font>`<font style="color:rgb(0, 0, 0);">share</font>`<font style="color:rgb(0, 0, 0);">表记录，返回</font>`<font style="color:rgb(0, 0, 0);">share_token</font>`
4. <font style="color:rgb(0, 0, 0);">前端生成链接：</font>`<font style="color:rgb(0, 0, 0);">http://ip:port/share?token={share_token}</font>`

### <font style="color:rgb(0, 0, 0);">4.3 关键技术实现</font>
+ **<font style="color:rgb(0, 0, 0) !important;">文件去重</font>**<font style="color:rgb(0, 0, 0);">：通过</font>`<font style="color:rgb(0, 0, 0);">MessageDigest</font>`<font style="color:rgb(0, 0, 0);">计算 MD5 哈希，对比数据库记录。</font>
+ **<font style="color:rgb(0, 0, 0) !important;">大模型集成</font>**<font style="color:rgb(0, 0, 0);">：封装 OpenAI SDK，配置 API Key，处理超时重试。</font>
+ **<font style="color:rgb(0, 0, 0) !important;">回收站清理</font>**<font style="color:rgb(0, 0, 0);">：使用</font>`<font style="color:rgb(0, 0, 0);">@Scheduled</font>`<font style="color:rgb(0, 0, 0);">定时任务，每天凌晨删除 30 天前的记录。</font>
+ **<font style="color:rgb(0, 0, 0) !important;">分享验证</font>**<font style="color:rgb(0, 0, 0);">：访问分享链接时，检查</font>`<font style="color:rgb(0, 0, 0);">share_token</font>`<font style="color:rgb(0, 0, 0);">是否存在且未过期。</font>

